import{_ as a,z as e,m as i,ap as s}from"./chunks/framework.BJGaVzEf.js";const c=JSON.parse('{"title":"Pull 模式","description":"","frontmatter":{},"headers":[],"relativePath":"markdown/mode/pull.md","filePath":"markdown/mode/pull.md","lastUpdated":1771239428000}'),o={name:"markdown/mode/pull.md"};function l(n,t,r,p,u,h){return i(),e("div",null,[...t[0]||(t[0]=[s('<h1 id="pull-模式" tabindex="-1">Pull 模式 <a class="header-anchor" href="#pull-模式" aria-label="Permalink to &quot;Pull 模式&quot;">​</a></h1><p>Pull 模式通过定时轮询 GitHub API 来获取仓库事件，适合没有公网 IP 或无法配置 Webhook 的场景。</p><h2 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to &quot;工作原理&quot;">​</a></h2><ol><li>适配器启动时，获取每个仓库的最新事件 ID</li><li>按照配置的轮询间隔，定时调用 GitHub Events API</li><li>比对事件 ID，只处理新产生的事件</li><li>将事件转换为 Koishi 消息并派发</li></ol><h2 id="优势" tabindex="-1">优势 <a class="header-anchor" href="#优势" aria-label="Permalink to &quot;优势&quot;">​</a></h2><p>✅ <strong>无需公网 IP</strong> - 适合本地开发和内网环境</p><p>✅ <strong>支持代理</strong> - 可配置 HTTP/HTTPS 代理访问 GitHub</p><p>✅ <strong>配置简单</strong> - 无需在 GitHub 配置 Webhook</p><p>✅ <strong>多仓库友好</strong> - 可同时监听多个仓库</p><h2 id="限制" tabindex="-1">限制 <a class="header-anchor" href="#限制" aria-label="Permalink to &quot;限制&quot;">​</a></h2><p>⚠️ <strong>实时性较差</strong> - 取决于轮询间隔，最快也有延迟</p><p>⚠️ <strong>API 配额限制</strong> - 频繁轮询会消耗 GitHub API 配额</p><p>⚠️ <strong>部分事件受限</strong> - 某些事件类型可能无法通过 Events API 获取</p><h2 id="api-配额说明" tabindex="-1">API 配额说明 <a class="header-anchor" href="#api-配额说明" aria-label="Permalink to &quot;API 配额说明&quot;">​</a></h2><p>GitHub API 对请求频率有限制：</p><ul><li><strong>认证请求</strong>: 5000 次/小时</li><li><strong>未认证请求</strong>: 60 次/小时</li></ul><h3 id="配额计算" tabindex="-1">配额计算 <a class="header-anchor" href="#配额计算" aria-label="Permalink to &quot;配额计算&quot;">​</a></h3><p>假设监听 N 个仓库，轮询间隔为 T 秒：</p><div class="language-log vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">log</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">每小时请求次数 = (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3600</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> / T) × N</span></span></code></pre></div><p>示例：</p><ul><li>监听 1 个仓库，间隔 30 秒：120 次/小时</li><li>监听 5 个仓库，间隔 60 秒：300 次/小时</li></ul><div class="tip custom-block"><p class="custom-block-title">提示</p><p>可以通过 GitHub API 响应头查看剩余配额：</p><ul><li><code>X-RateLimit-Limit</code>: 总配额</li><li><code>X-RateLimit-Remaining</code>: 剩余配额</li><li><code>X-RateLimit-Reset</code>: 重置时间</li></ul></div><h2 id="支持的事件类型" tabindex="-1">支持的事件类型 <a class="header-anchor" href="#支持的事件类型" aria-label="Permalink to &quot;支持的事件类型&quot;">​</a></h2><p>Pull 模式通过 <a href="https://docs.github.com/en/rest/activity/events" target="_blank" rel="noreferrer">GitHub Events API</a> 获取事件，支持以下类型：</p><p>✅ <strong>IssuesEvent</strong> - Issue 创建、关闭、重新打开</p><p>✅ <strong>IssueCommentEvent</strong> - Issue 评论</p><p>✅ <strong>PullRequestEvent</strong> - PR 创建、关闭、重新打开</p><p>✅ <strong>PullRequestReviewCommentEvent</strong> - PR 审查评论</p><p>❌ <strong>DiscussionEvent</strong> - Discussion 事件（API 不支持）</p><p>❌ <strong>DiscussionCommentEvent</strong> - Discussion 评论（API 不支持）</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>如果需要完整的 Discussion 事件支持，请使用 <a href="/koishi-plugin-adapter-github/markdown/mode/webhook.html">Webhook 模式</a>。</p></div><h2 id="代理配置" tabindex="-1">代理配置 <a class="header-anchor" href="#代理配置" aria-label="Permalink to &quot;代理配置&quot;">​</a></h2><p>Pull 模式支持通过代理访问 GitHub API，详见 <a href="/koishi-plugin-adapter-github/markdown/mode/proxy.html">代理配置</a>。</p>',33)])])}const g=a(o,[["render",l]]);export{c as __pageData,g as default};
